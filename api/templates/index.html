<h1>Exhibition Wishlist</h1>
{% if username %}
<p>Logged in as: <strong>{{ username }}</strong> </p>
<form action="/logout" method="GET">
    <button type="submit" class="btn btn-primary">Logout</button>
</form>
<hr>
<h2>Add an exhibition to the list:</h2>
<form action="/add_exhibition" method="GET">
    <button type="submit" class="btn btn-primary">Add exhibition</button>
</form>

{% with messages = get_flashed_messages() %}
  {% if messages %}
    {% for message in messages %}
        <strong>{{message}}</strong>
    {% endfor %}
  {% endif %}
{% endwith %}

<hr>
{% else %}
<form action="/login_page" method="GET">
    <button type="submit" class="btn btn-primary">Login</button>
</form> or
<form action="/sign_up_page" method="GET">
    <button type="submit" class="btn btn-primary">Sign up</button>
</form>

{% endif %}
    <h2>Currently open Exhibitions:</h2>
    <hr>
        {% for exhibition in current_exhibitions %}
            <p>{{ exhibition.start_date.strftime('%d.%m.%Y') }} - {{ exhibition.end_date.strftime('%d.%m.%Y') }}</p>
            <h3>{{ exhibition.exhibition_name }}</h3>
            <h5>{{ exhibition.museum_name }}</h5>
            <h6>closing in {{ exhibition.days_left }} days</h6>
            {% if username %}
                {% if exhibition.attendees %}
                <h3>Interested:
                    {% for attendee in exhibition.attendees %}
                        {{attendee['first_name']}}
                    {% endfor %}
                </h3>
                {% endif %}
                {% if exhibition.is_attending %}
                    <form action="{{ url_for('leave_exhibition', exhibition_id=exhibition.id) }}" method="POST">
                        <button class="btn btn-dark">Not interested</button>
                    </form>
                {% else %}
                    <form action="{{ url_for('join_exhibition', exhibition_id=exhibition.id) }}" method="POST">
                        <button class="btn btn-primary">Interested</button>
                    </form>
                {% endif %}
            {% endif %}
            <hr>
        {% endfor %}
    <hr>
    <h2>Past exhibitions:</h2>
    <hr>
        {% for exhibition in past_exhibitions %}
            <p>{{ exhibition.start_date.strftime('%d.%m.%Y') }} - {{ exhibition.end_date.strftime('%d.%m.%Y') }}</p>
            <h3>{{ exhibition.exhibition_name }}</h3>
            <h5>{{ exhibition.museum_name }}</h5>
            {% if exhibition.attendees %}
            <h3>Interested:
                {% for attendee in exhibition.attendees %}
                    {{attendee['first_name']}}
                {% endfor %}
            </h3>
            {% endif %}
        <hr>
        {% endfor %}

